<Window x:Class="CalcApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:viewModels="clr-namespace:CalcApp.ViewModels"
        Title="Modern Számológép" Width="540" MinWidth="520" Height="680" MinHeight="600"
        ResizeMode="CanResize"
        Background="{DynamicResource WindowBackgroundBrush}"
        KeyDown="Window_KeyDown" Focusable="True"
        WindowStartupLocation="CenterScreen"
        AllowsTransparency="False"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        RenderOptions.BitmapScalingMode="LowQuality"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType">

    <Window.DataContext>
        <viewModels:CalculatorViewModel />
    </Window.DataContext>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Border CornerRadius="24" BorderBrush="{DynamicResource ButtonBackgroundBrush}"
                    BorderThickness="1" Padding="16"
                    Background="{DynamicResource BorderBackgroundBrush}"
                    UseLayoutRounding="True" SnapsToDevicePixels="True">
                <TextBox x:Name="Display" FontSize="48" FontWeight="Light"
                         HorizontalAlignment="Stretch" VerticalAlignment="Center"
                         Text="{Binding Display, Mode=OneWay}" TextAlignment="Right" IsReadOnly="True" BorderThickness="0"
                         Background="Transparent" Foreground="{DynamicResource BorderForegroundBrush}"
                         Effect="{DynamicResource NeonTextEffect}"
                         UseLayoutRounding="True" SnapsToDevicePixels="True"
                         TextOptions.TextFormattingMode="Display"
                         TextOptions.TextRenderingMode="ClearType"
                         RenderOptions.ClearTypeHint="Enabled">
                    <TextBox.CacheMode>
                        <BitmapCache EnableClearType="True" RenderAtScale="1" SnapsToDevicePixels="True" />
                    </TextBox.CacheMode>
                </TextBox>
            </Border>
        </Grid>

        <Border Grid.Row="1" Margin="0,16,0,0" Padding="16"
                Background="{DynamicResource BorderBackgroundBrush}"
                CornerRadius="20"
                BorderBrush="{DynamicResource ButtonBackgroundBrush}"
                BorderThickness="1"
                SnapsToDevicePixels="True">

            <Grid SnapsToDevicePixels="True">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <TextBlock Text="Memória" FontSize="14" FontWeight="SemiBold"
                           Margin="0,0,0,8" Foreground="{DynamicResource BorderForegroundBrush}" Opacity="0.7"
                           TextOptions.TextFormattingMode="Display" />
                <ListBox x:Name="MemoryList" Grid.Row="1" ItemsSource="{Binding MemoryItems}"
                         Foreground="{DynamicResource BorderForegroundBrush}"
                         Background="Transparent" BorderThickness="0"
                         FontSize="14" FontWeight="Normal"
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         ScrollViewer.CanContentScroll="True"
                         ScrollViewer.IsDeferredScrollingEnabled="True"
                         VirtualizingPanel.IsVirtualizing="True"
                         VirtualizingPanel.VirtualizationMode="Recycling"
                         VirtualizingPanel.CacheLength="1,1"
                         VirtualizingPanel.CacheLengthUnit="Page"
                         VirtualizingPanel.ScrollUnit="Pixel" />
            </Grid>
        </Border>

        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Button Content="sin" Grid.Row="0" Grid.Column="0" Command="{Binding SinCommand}" />
            <Button Content="cos" Grid.Row="0" Grid.Column="1" Command="{Binding CosCommand}" />
            <Button Content="tan" Grid.Row="0" Grid.Column="2" Command="{Binding TanCommand}" />
            <Button Content="√" Grid.Row="0" Grid.Column="3" Command="{Binding SqrtCommand}" />

            <Button Content="n!" Grid.Row="1" Grid.Column="0" Command="{Binding FactorialCommand}" />
            <Button Content="M+" Grid.Row="1" Grid.Column="1" Command="{Binding MemoryAddCommand}" />
            <Button Content="M-" Grid.Row="1" Grid.Column="2" Command="{Binding MemorySubtractCommand}" />
            <Button Content="MR" Grid.Row="1" Grid.Column="3" Command="{Binding MemoryRecallCommand}" />

            <Button Content="MC" Grid.Row="2" Grid.Column="0" Command="{Binding MemoryClearCommand}" />
            <Button Content="C" Grid.Row="2" Grid.Column="1" Command="{Binding ClearCommand}" Foreground="#FFEF5350" FontWeight="Bold" />
            <Button Content="Törlés" Grid.Row="2" Grid.Column="2" Command="{Binding DeleteCommand}" />
            <Button Content="%" Grid.Row="2" Grid.Column="3" Command="{Binding PercentCommand}" />

            <Button Content="7" Tag="7" Grid.Row="3" Grid.Column="0" Command="{Binding DigitCommand}" CommandParameter="7" />
            <Button Content="8" Tag="8" Grid.Row="3" Grid.Column="1" Command="{Binding DigitCommand}" CommandParameter="8" />
            <Button Content="9" Tag="9" Grid.Row="3" Grid.Column="2" Command="{Binding DigitCommand}" CommandParameter="9" />
            <Button Content="÷" Grid.Row="3" Grid.Column="3" Command="{Binding OperatorCommand}" CommandParameter="/" Foreground="{DynamicResource GlowBrush}" />

            <Button Content="4" Tag="4" Grid.Row="4" Grid.Column="0" Command="{Binding DigitCommand}" CommandParameter="4" />
            <Button Content="5" Tag="5" Grid.Row="4" Grid.Column="1" Command="{Binding DigitCommand}" CommandParameter="5" />
            <Button Content="6" Tag="6" Grid.Row="4" Grid.Column="2" Command="{Binding DigitCommand}" CommandParameter="6" />
            <Button Content="×" Grid.Row="4" Grid.Column="3" Command="{Binding OperatorCommand}" CommandParameter="*" Foreground="{DynamicResource GlowBrush}" />

            <Button Content="1" Tag="1" Grid.Row="5" Grid.Column="0" Command="{Binding DigitCommand}" CommandParameter="1" />
            <Button Content="2" Tag="2" Grid.Row="5" Grid.Column="1" Command="{Binding DigitCommand}" CommandParameter="2" />
            <Button Content="3" Tag="3" Grid.Row="5" Grid.Column="2" Command="{Binding DigitCommand}" CommandParameter="3" />
            <Button Content="−" Grid.Row="5" Grid.Column="3" Command="{Binding OperatorCommand}" CommandParameter="-" Foreground="{DynamicResource GlowBrush}" />

            <Button Content="." Grid.Row="6" Grid.Column="2" Command="{Binding DecimalCommand}" />
            <Button Content="0" Tag="0" Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" Command="{Binding DigitCommand}" CommandParameter="0" />
            <Button Content="xʸ" Grid.Row="6" Grid.Column="3" Command="{Binding OperatorCommand}" CommandParameter="^" Foreground="{DynamicResource GlowBrush}" />

            <Button Content="Előjel" Grid.Row="7" Grid.Column="0" Command="{Binding SignCommand}" />
            <Button Content="=" Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="3" Command="{Binding EqualsCommand}"
                    Background="{DynamicResource AccentButtonBrush}" FontWeight="Bold" FontSize="24" />
        </Grid>

    </Grid>
</Window>
